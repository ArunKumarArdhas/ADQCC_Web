@{
    ViewData["Title"] = "Login";
    Layout = null;
}
<link href="~/assets/libs/sweetalert2/sweetalert2.min.css" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/assets/fonts/nakheelfont.css")" rel="stylesheet" />
<script src="@Url.Content("~/assets/pages/datatables/jquery.min.js")"></script>
<script src="~/assets/libs/sweetalert2/sweetalert2.min.js"></script>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title> ZEROHARM |  ABU DHABI QUALITY AND CONFORMITY COUNCIL</title>
    @*<title>NEOEHS</title>*@
    <link href="~/assets/_new_dashboard/assets/css/bootstrap.min.css" rel="stylesheet" />
    @*     <link href="@Url.Content("~/Content/assets/vendor/bootstrap/css/bootstrap.min.css")" rel="stylesheet"> *@
    @* <link href="@Url.Content("~/Content/assets/css/login.css")" rel="stylesheet" /> *@
    <link href="~/assets/css/login.css" rel="stylesheet" />
    @*     <link href="@Url.Content("~/Content/dist/css/toastr.css")" rel="stylesheet" /> *@
    @*    <link href="~/dist/css/toastr.css" rel="stylesheet" /> *@

    <link href="@Url.Content("~/dist/css/toastr.css")" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600&family=Sen:wght@400;700&display=swap" rel="stylesheet">
    <style>
        .my-auto {
            margin-top: 100px !important;
            /* margin-bottom: auto!important; */
        }
    </style>
</head>

<body style="font-family: 'Poppins', sans-serif;">
    <main>
        <div class="container-fluid">
            <div class="row">

                <div class="col-sm-5 px-0 d-none d-sm-block">
                    <img src="~/assets/images/left2.jpg" alt="login image" class="login-img" />
                </div>
                <div class="col-sm-6 login-section-wrapper">
                    <div class="brand-wrapper">
                    </div>
                    <div class="login-wrapper my-auto FnLogin">
                        <h1 class="login-title">Log in</h1>

                        <form action="#" id="Frm_Login" method="post">

                            @Html.AntiForgeryToken()
                            <div id="LoginDiv">
                                <div class="form-group">
                                    <label for="email">Username</label>
                                    <input type="email" name="email" id="Username" class="form-control" placeholder="Username">
                                    @* <label id="name-error" class="login" for="name" style="display: none; color: #f71313;">@ADQCC_New.LocalResource.Resource.EntertheUsername</label> *@
                                    <label id="name-error" class="login" for="name" style="display: none; color: #f71313;">@ADQCC_New.LocalResource.Resource.EntertheUsername</label>
                                </div>
                                <div class="form-group mb-4">
                                    <label for="password">Password</label>
                                    <input type="password" name="password" id="Password" class="form-control" placeholder="Password">
                                    <label id="name-error" class="pasword" for="name" style="display: none; color: #f71313;">@ADQCC_New.LocalResource.Resource.EnterthePassword</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" value="ar" checked name="Language">
                                    <label class="form-check-label" for="inlineRadio2">Arabic</label>
                                </div>
                                <div class="form-check form-check-inline  mb-4">
                                    <input class="form-check-input" type="radio" value="en" name="Language">
                                    <label class="form-check-label" for="inlineRadio1">English</label>
                                </div>
                                <input name="login" id="login" class="btn btn-block login-btn" type="button" value="Generate OTP" onclick="validataionOTP()">
                            </div>

                            <div id="OptDiv" style="display:none;">
                                @* <form asp-action="LoginAsync" asp-controller="Account" id="LoginFRM2" method="post" autocomplete="off"> *@
                                <div class="form-group mb-4">
                                    <label for="password">OTP</label>
                                    <input type="password" name="OTP" id="OTP" class="form-control numbersonly" data-toggle="tooltip" title="Numbers Only" placeholder="OTP">
                                    <label id="name-error" class="OTP" for="OTP" style="display: none; color: #f71313;">@ADQCC_New.LocalResource.Resource.EnterthePassword</label>
                                </div>
                                <input name="login1" id="login1" class="btn btn-block login-btn" type="button" value="Login" onclick="validataionLogin()">
                                @* <input name="login1" id="login1" class="btn btn-block login-btn" type="submit" value="Login"> *@
                                @* </form> *@
                            </div>
                        </form>
                        <div class="row mb-4">
                            <div class="form-check font-size-15" onclick="FnForgotPassword()">
                                <label class="form-check-label font-size-15" for="forgot-password">Forgot Password<span class="text-muted">?</span></label>
                            </div>
                        </div>
                    </div>
                    <div class="auth-content my-auto FnForgotpass" style="display:none">
                        <form>
                            <div class="form-floating form-floating-custom mb-4">
                                <input type="text" class="form-control" id="User_Name" placeholder="Enter User Name" autocomplete="off" required minlen="1" name="User_Name">
                                <label for="input-username">Username</label>
                                <div class="form-floating-icon"><i data-eva="people-outline"></i></div>
                            </div>
                            <div class="row mb-4">
                                <div class="form-check font-size-15" onclick="Fnback()">
                                    <label class="form-check-label font-size-15" style="color:black" for="forgot-password">Back<span class="text-muted">?</span></label>
                                </div>
                            </div>
                            <div class="mb-3">
                                <button type="button" class="btn btn-primary w-100 waves-effect waves-light" onclick="Fn_forgotpassword()">Submit</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <div id="Loader" style="display: none;">
        @* <img src="@Url.Content("~/Content/dist/img/loader.gif")" al alt="" /> *@
        <img src="~/dist/img/loader.gif" />
    </div>
</body>
</html>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
@*<script src="@Url.Content("~/Content/dist/js/jquery-3.6.0.min.js")"></script> *@

<script src="@Url.Content("~/dist/js/jquery-3.6.0.min.js")"></script>
@* <script src="@Url.Content("~/Content/dist/js/toastr.min.js")"></script>*@
<script src="@Url.Content("~/dist/js/toastr.min.js")"></script>
@* <script src="@Url.Content("~/Content/assets/vendor/bootstrap/js/bootstrap.min.js")"></script> *@
<script src="~/assets/vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="~/assets/js/form-validation.js"></script>
@*<script src="~/Content/assets/js/form-validation.js"></script> *@
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
<script>
    $(document).ready(function () {
        $(document).bind("contextmenu", function (e) {
            return false;
        });

        $("#Username").keypress(function () {
            $('.login').hide();
            $('#Username').css('border-color', 'black');
        });
        $("#Password").keypress(function () {
            $('.pasword').hide();
            $('#Password').css('border-color', 'black');
        });
        $(".numbersonly").keypress(function (e) {
            if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57) && e.which != 9 && (e.which < 37 || e.which > 40) && (e.which < 37 || e.which > 40)) {
                $(this).val('');
                return false;
            }
            else {
                return true;
            }
        });
    });
    function username() {
        $('.login').hide();
        $('#Username').css('border-color', 'black');
    }
    function password() {
        $('.pasword').hide();
        $('#Password').css('border-color', 'black');
    }
    function language() {
        $('.language').hide();
        $('#Language').css('border-color', 'black');
    }


    function validataionOTP() {
       // alert("Login");
        debugger;
        $("#Loaderbck").show(), $("#Loader").show();
        var e = $("#Username").val(),
            a = $("#Password").val(),
            r = $('#OTP').val();
        if ("" == e) return $("#Loader").css("display", "none"), $(".login").show(), $("#Username").css("border-color", "red"), $("#Username").focus(), submit = 0, !1;
        if ("" == a) return $(".pasword").show(), $("#Password").css("border-color", "red"), $("#Password").focus(), $("#Loader").css("display", "none"), submit = 0, !1;
        if ("0" == r) return $(".language").show(), $("#Language").focus(), $("#Loader").css("display", "none"), submit = 0, !1;
        var n = $("#Frm_Login"),
            r = {
                __RequestVerificationToken: $('input[name="__RequestVerificationToken"]', n).val(),
                UserName: e,
                Password: a,
                LANG_ID: r
            },
            r = $.param(r);
        $.ajax({
            url: "/Account/LoginOTPAsync",
            type: "POST",
            cache: false,
            async: false,
            dataType: "json",
            data: r,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            success: function (response) {
                if (response.STATUS_CODE === "200") {
                    $("#LoginDiv").hide(100);
                    $("#OptDiv").show(100);
                } else {
                    toastr.error(response.MESSAGE || "User does not exist.", "Error");
                }
            },
            error: function (xhr, status, error) {
                console.error("AJAX Error Details:");
                console.error("Status: ", status);
                console.error("Error: ", error);
                console.error("Response Text: ", xhr.responseText);
                toastr.error("An error occurred while processing the request.", "Error");
            },
            complete: function () {
                $("#Loaderbck").hide();
                $("#Loader").hide();
            }
        });
    }
    function validataionLogin() {
        //alert("OTP");
        $("#Loaderbck").show(), $("#Loader").show();
        var e = $("#Username").val(),
            a = $("#Password").val(),
            r = $('#OTP').val();
        if ("" == e) return $("#Loader").css("display", "none"), $(".login").show(), $("#Username").css("border-color", "red"), $("#Username").focus(), submit = 0, !1;
        if ("" == a) return $(".pasword").show(), $("#Password").css("border-color", "red"), $("#Password").focus(), $("#Loader").css("display", "none"), submit = 0, !1;
        if ("0" == r) return $(".language").show(), $("#Language").focus(), $("#Loader").css("display", "none"), submit = 0, !1;
        var n = $("#Frm_Login"),
            r = {
                __RequestVerificationToken: $('input[name="__RequestVerificationToken"]', n).val(),
                UserName: e,
                Password: a,
                OTP: r
            },
            r = $.param(r);
        $.ajax({
            url: "/Account/LoginAsync",
            type: "POST",
            cache: false,
            async: false,
            dataType: "json",
            data: r,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            success: function (data) {
                ;
                if (data.STATUS == 1) {
                    debugger;
                    sessionStorage.setItem("LANG_ID", data.USER_DETAILS.LANG_ID);
                    toastr.success(data.MESSAGE, "Success");
                    $('#loginpassword').val("");
                    setTimeout(function () {
                        var langid = sessionStorage.getItem("LANG_ID");
                        window.location.href = '@Url.Action("Index", "Home")?LanguageAbbrevation=' + langid;
                        //window.location.href = 'Url.Action("AdminDashboard", "Dashboard")?LanguageAbbrevation=' + langid;
                    }, 200);
                }
                else {
                    $("#loginpassword").val("");
                    submit = 0;
                    toastr.error(data.MESSAGE, "Error");
                }
            },
            // success: function (response) {
            //     debugger;
            //     alert(response);
            //     debugger;
            //     if (response.STATUS_CODE === "200") {
            //         //alert(response.STATUS_CODE);
            //         //sessionStorage.setItem("LANG_ID", data.USER_DETAILS.LANG_ID);
            //         toastr.success(response.MESSAGE, "Success");
            //         //window.location.href = "https://localhost:44365/Home/Index";
            //         window.location.href = '@Url.Action("Index", "Home")';
            //         $('#loginpassword').val("");
            //         setTimeout(function () {
            //             var langid = sessionStorage.getItem("LANG_ID");
            //             window.location.href = '@Url.Action("Index", "Home")?LanguageAbbrevation=' + langid;
            //         }, 200);
            //     } else {
            //         toastr.error(response.MESSAGE || "OTP Mismatch", "Error");
            //     }
            // },
            error: function (xhr, status, error) {
                alert("Error");
                // console.error("AJAX Error Details:");
                // console.error("Status: ", status);
                // console.error("Error: ", error);
                // console.error("Response Text: ", xhr.responseText);
                // toastr.error("An error occurred while processing the request.", "Error");
                toastr.success(response.MESSAGE, "Success");
            },
            complete: function () {
                $("#Loaderbck").hide();
                $("#Loader").hide();
            }
        });

    }
</script>
<script>
    // function validataionLogin() {
    //     alert("OTP");
    //     var Obj = {
    //         UserName: $("#Username").val(),
    //         Password: $("#Password").val(),
    //         OTP: $("#OTP").val(),
    //         LANG_ID = $('input[name="Language"]:checked').val();
    //     };
    //     //LANG_ID = $('input[name="Language"]:checked').val(); $("#Loaderbck").show(), $("#Loader").show();
    //     $.ajax({
    //         url: "/Account/LoginAsync",
    //         type: "POST",
    //         cache: false,
    //         data: JSON.stringify(Obj),
    //         contentType: "application/json; charset=utf-8",
    //         dataType: "json",
    //         success: function (data) {
    //             debugger;
    //             if (data == "200") {
    //                 debugger;
    //                 Swal.fire({
    //                     position: 'top-end',
    //                     icon: 'success',
    //                     title: 'Login Successfully',
    //                     showConfirmButton: false,
    //                     timer: 1500
    //                 }).then(function () {
    //                     window.location.reload();
    //                 });
    //             }
    //             else {
    //                 // Swal.fire({
    //                 //     position: 'top-end',
    //                 //     icon: 'Error',
    //                 //     title: 'Error',
    //                 //     showConfirmButton: false,
    //                 //     timer: 1500
    //                 // });
    //             }
    //         },
    //     });
    // }
</script>

