@using ADQCC_New.Models;
@using static ADQCC_New.Common.CommonClass;
@using Newtonsoft.Json;

@inject IHttpContextAccessor HttpContextAccessor;

@{
    ViewBag.Title = "EmergencyTeamMembers";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var str = HttpContextAccessor.HttpContext!.Session.GetString("LoginAccount");
    string Des = Decrypt(str!);
    var loginclass = JsonConvert.DeserializeObject<GET_USER_DETAILS>(Des!)!;
}

<link href="@Url.Content("~/Content/MultiSelect/New/css/fileinput.css")" rel="stylesheet" />
<link href="@Url.Content("~/Content/FontAwesome_5/fontawesome-free-6.1.1-web/css/all.min.css")" rel="stylesheet" />
<link href="~/Content/MultiSelect/New/css/fileinput.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/microsoft/signalr@latest/dist/browser/signalr.min.js"></script>


<style>
    .kv-file-remove {
        display: none !important;
    }

    .file-preview-image {
        font: 16px Impact, Charcoal, sans-serif !important;
        width: 100% !important;
    }

    .file-preview {
        width: 100% !important;
    }

    .btn-default {
        background-color: #f5f5f5;
        color: #000;
        border-color: #ddd;
    }

    .btn-primary {
        color: #fff !important;
        background-color: #cdae7b !important;
        border-color: #cdae7b !important;
    }

    .persDet {
        border-left: 1px solid #f39c12 !important;
        border-right: 1px solid #f39c12 !important;
        border-bottom: 1px solid #f39c12 !important;
    }
</style>


<style>
    .dataTables_length {
        direction: ltr !important;
    }

    .btn-group, .btn-group-vertical {
        position: relative;
        display: inline-flex;
        vertical-align: middle;
        float: right !important;
        margin-top: -62px !important;
        padding: 32px !important;
    }

    div.dataTables_wrapper div.dataTables_filter {
        text-align: right;
        margin-top: -28px !important;
    }

    .btn-group, .btn-group-vertical {
        position: relative;
        display: inline-flex;
        vertical-align: middle;
    }

    .red {
        color: red
    }
</style>

<div class="page-content">
    <div class="row" id="AddEmrType" style="display:none;">
        <div class="col-md-12">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-9">
                            <h6 class="mb-0 text-uppercase col-lg-8">@ADQCC_New.LocalResource.Resource.EMREmergencyTypelabel</h6>
                        </div>
                        <div class="col-lg-3">
                            @if (loginclass.LANG_ID == "ar")
                            {
                                <button style="float: left;" id="Backbtn" class="btn btn-primary">@ADQCC_New.LocalResource.Resource.Back</button>
                            }
                            else
                            {
                                <button style="float: right;" id="Backbtn" class="btn btn-primary">@ADQCC_New.LocalResource.Resource.Back</button>
                            }
                        </div>
                    </div>
                    <hr />
                    <div class="p-4 border rounded">
                        <form action="" class="form-horizontal" method="get" id="actionformsearch" accept-charset="utf-8">
                            <div class="row">
                                <div class="col-md-4" style="display:none;">
                                    <label>@ADQCC_New.LocalResource.Resource.EMREmergencyActiveID <span class="red">*</span></label>
                                    <input type="text" name="EmpActiveId" value="0" id="EmpActiveId" class="form-control" disabled style="background-color:white;" />
                                </div>

                                <div class="col-md-4">
                                    <label for="EmpTeam" class="control-label">@ADQCC_New.LocalResource.Resource.EMREmergencyTeam <span class="red">*</span></label>
                                    <select name="EmpTeam" class=form-control id="EmpType">
                                        @*<option value="0" style="color:#D5D5D5;">--@ADQCC_New.LocalResource.Resource.LEGALSelect--</option>*@
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="empGender" class="control-label">@ADQCC_New.LocalResource.Resource.Location <span class="red">*</span></label>
                                    <select name="loc_types" class=form-control id="location">
                                        @*<option value="0" style="color:#D5D5D5;">--@ADQCC_New.LocalResource.Resource.SelectLocation--</option>*@
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="dob" class="control-label">@ADQCC_New.LocalResource.Resource.Building<span class="red">*</span></label>

                                    <select name="loc_types" class=form-control id="Building">
                                        @*<option value="0" style="color:#D5D5D5;">--@ADQCC_New.LocalResource.Resource.SelectBuilding--</option>*@
                                    </select>
                                </div>
                            </div>
                            <br />
                            <div class="row">
                                <div class="col-md-4">
                                    <label for="LEVEL" class="control-label">@ADQCC_New.LocalResource.Resource.EMRFloorLevel<span class="red">*</span></label>
                                    <select name="LEVEL" class=form-control id="LEVEL" onchange="EmrEmployeeload()">
                                        <option value="0">--@ADQCC_New.LocalResource.Resource.EMRSelectTeamLevel--</option>
                                        <option value="8">@ADQCC_New.LocalResource.Resource.All</option>
                                        <option value="1">@ADQCC_New.LocalResource.Resource.EMRLevel1</option>
                                        <option value="2">@ADQCC_New.LocalResource.Resource.EMRLevel2</option>
                                        <option value="3">@ADQCC_New.LocalResource.Resource.EMRLevel3</option>
                                        <option value="4">@ADQCC_New.LocalResource.Resource.EMRLevel4</option>
                                        <option value="5">@ADQCC_New.LocalResource.Resource.EMRLevel5</option>
                                        <option value="6">@ADQCC_New.LocalResource.Resource.EMRLevel6</option>
                                        <option value="7">@ADQCC_New.LocalResource.Resource.EMRLevel7</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6" id="DivTable" style="display:none;">
                                    <label>@ADQCC_New.LocalResource.Resource.TMEmployee <span class="red">*</span></label>
                                    <div class="table-responsive" style=" overflow-y: scroll; height: 200px;width:400px;">

                                        <table class="table table-bordered" id="tblTM_Employee_View">
                                            <tbody>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <!--/ row-->
                            <div class="row" style="display:none;">
                                <div class="row">
                                    <div class="col-lg-9">
                                        <h6 class="mb-0 text-uppercase col-lg-8">@ADQCC_New.LocalResource.Resource.INSPVenueDetails</h6>
                                    </div>
                                    <div class="col-lg-3">
                                        <button style="float: right;" onclick="BtnBack()" class="btn btn-primary">@ADQCC_New.LocalResource.Resource.Back</button>
                                    </div>
                                </div>
                                <hr />
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="dob" class="control-label">@ADQCC_New.LocalResource.Resource.SectorName<span class="red">*</span></label>
                                            <select class="form-control" id="sectorname">
                                                <option value="0" style="color:#D5D5D5;">--@ADQCC_New.LocalResource.Resource.SelectSectorName--</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="empGender" class="control-label">@ADQCC_New.LocalResource.Resource.Department <span class="red">*</span></label>
                                        <select class="form-control" id="department">
                                            <option value="0" style="color:#D5D5D5;">--@ADQCC_New.LocalResource.Resource.SelectDepartment--</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="dob" class="control-label">@ADQCC_New.LocalResource.Resource.Section_LabName<span class="red">*</span></label>
                                            <select name="loc_types" class=form-control id="section">
                                                <option value="0">--@ADQCC_New.LocalResource.Resource.SelectSection--</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row" style="display:none;">
                                <div class="row">
                                    <div class="col-lg-9">
                                        <h6 class="mb-0 text-uppercase col-lg-8">@ADQCC_New.LocalResource.Resource.EMRScenarioNeedtoFollow</h6>
                                    </div>
                                </div>
                                <hr />

                                <div class="col-lg-6" id="DivEditkvexplorer" style="display:none;">
                                    <script src="~/Content/MultiSelect/New/js/fileinput.js"></script>
                                    <script src="~/Content/MultiSelect/New/js/locales/fr.js"></script>
                                    <script src="~/Content/MultiSelect/New/js/locales/es.js"></script>
                                    <script src="~/Content/MultiSelect/New/themes/fas/theme.js"></script>
                                    <script src="~/Content/MultiSelect/New/themes/explorer-fas/theme.js"></script>
                                    <div class="col-md-4">
                                        <label for="person1" class="control-label">@ADQCC_New.LocalResource.Resource.TMFileUpload<span class="red">*</span></label>
                                        <br />
                                    </div>
                                    <div>
                                        <input id="kv-explorer" type="file" multiple style="width:200px">
                                    </div>

                                    <br />
                                </div>
                                <div class="row">
                                    <div class="col-lg-12" style="display:none;">
                                        <label>@ADQCC_New.LocalResource.Resource.TMUploadFile<span class="red">*</span></label>
                                        <div class="form-group col-lg-12 DivViewAPPENDIX_A" id="DivViewAPPENDIX_A" style="display:none;">
                                        </div>
                                        <input type="hidden" id="hdnAPPENDIX_A" class="hdncls_APPENDIX_A APPENDIX_A_Viewhide hdncls_APPENDIX_A0" />
                                        <input id="APPENDIX_A" class="photo APPENDIX_A_Viewhide hdncls_APPENDIX_A0" name="StudImage" type="file" accept=".pdf,.doc,.docx" />
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="row">
                                    <div class="col-lg-9">
                                        <h6 class="mb-0 text-uppercase col-lg-8">@ADQCC_New.LocalResource.Resource.EMRAssignedTask</h6>
                                    </div>
                                </div>
                                <hr />
                                <div class="row">
                                    <div class="col-md-12">
                                        <table class="table table-bordered" id="TblTaskAssign">
                                            <thead>
                                                <tr>
                                                    <td align="left" valign="middle" style="background-color: #cdae7b; color: white;">@ADQCC_New.LocalResource.Resource.EMRTask</td>
                                                    <td align="left" valign="middle" style="background-color: #cdae7b; color: white;">@ADQCC_New.LocalResource.Resource.EMRTaskDescription</td>
                                                    <td align="left" valign="middle" style="background-color: #cdae7b; color: white;">@ADQCC_New.LocalResource.Resource.EMRReviewDate</td>
                                                </tr>
                                            </thead>
                                            <tbody id="TaskAssignBody">
                                        </table>
                                    </div>

                                </div>
                            </div>

                            <div id="UploadedFiles" style="display:none;">
                                <div class="form-group col-lg-12" id="DivViewImage"></div>
                                <br />
                                <div class="form-group col-lg-12" id="DivViewVideo"></div>
                            </div>

                            <div class="row" id="SECHeadApprovepage">
                                <div class="col-md-5"></div>
                                <div class="col-md-7">
                                    <button class="btn btn-primary pull-right" onclick="Approve_Fuction('1')" id="SECHead_ManagerApprove" style="width: 110px; background-color: forestgreen; color: white">
                                        @ADQCC_New.LocalResource.Resource.EMRAccept
                                    </button>
                                    <button class="btn btn-primary pull-left" onclick="Approve_Fuction('2')" style="width: 150px; background-color: #cdae7b; color: white">
                                        @ADQCC_New.LocalResource.Resource.EMRNotAvailable
                                    </button>
                                </div>
                            </div>

                            <div id="SubmitActionTakenDiv">
                                <div class="row rowStyl">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label for="Action" class="control-label">@ADQCC_New.LocalResource.Resource.EMREnterActionTaken<span class="red">*</span></label>
                                            <textarea id="ActionTaken" style="width: 100%; padding: 2%; resize: none;"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    @if (loginclass.LANG_ID == "ar")
                                    {
                                        <div class="col-lg-6">
                                            <br />
                                            <div class="col-md-12">
                                                <label for="person1" class="control-label">@ADQCC_New.LocalResource.Resource.NMUploadPhotos</label>
                                                <br />
                                            </div>
                                            <div>
                                                <input class="btn btn-default btn-file" id="spnInputfile" type="file" multiple style="width:200%">

                                                @*<span class="btn btn-default btn-file" id="spnInputfile" style="width: 100%;"></span>*@
                                            </div>
                                            <br />
                                        </div>

                                        <div class="col-lg-6">
                                            <br />
                                            <div class="col-md-12">

                                                <label for="person1" class="control-label">@ADQCC_New.LocalResource.Resource.NMUploadVideo</label>
                                                <br />
                                            </div>
                                            <div>
                                                <input class="btn btn-default btn-file" id="spnInputfileVideo" type="file" multiple style="width:200%">

                                                @*<span class="btn btn-default btn-file" id="spnInputfileVideo" style="width: 100%;"></span>*@
                                            </div>
                                            <br />
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="row col-md-12">
                                            <div class="form-group col-md-6">
                                                <b style="font-size: 16px;">@ADQCC_New.LocalResource.Resource.NMUploadPhotos</b><span style="color: #c5c5c5"></span>
                                                <div class="file-loading">
                                                    <input id="input-7051" name="kartik-input-7051[]" type="file" accept="image/*" multiple>
                                                </div>&nbsp;&nbsp;
                                            </div>
                                            <div class="form-group col-md-6">
                                                <b style="font-size: 16px;">@ADQCC_New.LocalResource.Resource.NMUploadVideo</b><span style="color: #c5c5c5"></span>
                                                <div class="">
                                                    <input id="input-7061" name="kartik-input-7061[]" type="file" accept="video/*" multiple>
                                                </div>
                                            </div>
                                        </div>
                                        @*<div class="col-lg-6">
                <br />
                <div class="col-md-4">
                    <label for="person1" class="control-label">@ADQCC_New.LocalResource.Resource.NMUploadPhotos</label>
                    <br />
                </div>
                <div>
                    <span class="btn btn-default btn-file" id="spnInputfile" style="width: 100%;"></span>
                </div>
                <br />
            </div>

            <div class="col-lg-6">
                <br />
                <div class="col-md-4">
                    <label for="person1" class="control-label">@ADQCC_New.LocalResource.Resource.NMUploadVideo</label>
                    <br />
                </div>
                <div>
                    <span class="btn btn-default btn-file" id="spnInputfileVideo" style="width: 100%;"></span>
                </div>
                <br />
            </div>*@
                                    }

                                </div>
                                <div class="col-lg-5"></div>
                                <div class="col-lg-7">
                                    <button href="#" class="btn btn-danger" onclick="SubmitActionTaken()" id="SubmitActionTakenbtn" style="width: 110px; background-color: #cdae7b; color: white">
                                        @ADQCC_New.LocalResource.Resource.Submit
                                    </button>
                                </div>

                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row" id="ListView">
        <div class="col-md-12">
            <label style="float: right;color:blue;" onclick="FunctionHelp()">@ADQCC_New.LocalResource.Resource.Help</label>
            <br />
            <div class="card">
                <div class="card-body">
                    <div>
                        <div class="row">
                            <div class="col-lg-9">
                                @if (loginclass != null)
                                {
                                    if (loginclass.LANG_ID == "bo")
                                    {
                                        <div class="row">
                                            <h5 class="d-flex align-items-center mb-3 col-lg-8">Emergency Team Activate</h5>
                                            <h5 class="d-flex align-items-center mb-3 col-lg-4">
                                                تفعيل فريق الطوارئ
                                            </h5>
                                        </div>

                                    }
                                    else
                                    {
                                        <h3 class="d-flex align-items-center mb-3">@ADQCC_New.LocalResource.Resource.EMREmergencyTeamActivatelabel</h3>
                                    }
                                }
                            </div>
                        </div>
                        <hr />
                        <div class="row">
                            <div class="table-responsive">
                                <table id="table1" class="table table-striped table-bordered">
                                    @if (loginclass != null)
                                    {
                                        switch (loginclass.LANG_ID)
                                        {
                                            case "ar":
                                                <thead>
                                                    <tr style="background: #916d2a; color: white;">
                                                        <th align="left" valign="middle">Emergency Active ID<span class="pull-right">معرف الفئة</span></th>
                                                        <th align="left" valign="middle">Emergency Type<span class="pull-right">نوع الطوارئ</span></th>
                                                        <th align="left" valign="middle">Created By<span class="pull-right">انشأ من قبل</span></th>
                                                        <th align="left" valign="middle">Created Date<span class="pull-right">تاريخ الإنشاء</span></th>
                                                        <th align="left" valign="middle">Status<span class="pull-right">حالة</span></th>
                                                        <th align="left" valign="middle">Action<span class="pull-right">عمل</span></th>
                                                    </tr>

                                                </thead>
                                                break;
                                            case "en":
                                                <thead>
                                                    <tr style="background: #916d2a; color: white;">
                                                        <th align="left" valign="middle">@ADQCC_New.LocalResource.Resource.EMREmergencyActiveID</th>
                                                        <th align="left" valign="middle">@ADQCC_New.LocalResource.Resource.EMREmergencyType</th>
                                                        <th align="left" valign="middle">@ADQCC_New.LocalResource.Resource.CreatedBy</th>
                                                        <th align="left" valign="middle">@ADQCC_New.LocalResource.Resource.TMCreatedDate</th>
                                                        <th align="left" valign="middle">@ADQCC_New.LocalResource.Resource.Status</th>
                                                        <th align="left" valign="middle">@ADQCC_New.LocalResource.Resource.Action</th>
                                                    </tr>
                                                </thead>
                                                break;
                                            default:
                                                <thead>
                                                    <tr style="background: #916d2a; color: white;">
                                                        <th align="left" valign="middle">@ADQCC_New.LocalResource.Resource.EMREmergencyActiveID</th>
                                                        <th align="left" valign="middle">@ADQCC_New.LocalResource.Resource.EMREmergencyType</th>
                                                        <th align="left" valign="middle">@ADQCC_New.LocalResource.Resource.CreatedBy</th>
                                                        <th align="left" valign="middle">@ADQCC_New.LocalResource.Resource.TMCreatedDate</th>
                                                        <th align="left" valign="middle">@ADQCC_New.LocalResource.Resource.Status</th>
                                                        <th align="left" valign="middle">@ADQCC_New.LocalResource.Resource.Action</th>
                                                    </tr>
                                                </thead>
                                                break;
                                        }

                                    }
                                    <tbody id="GetEmrTeamActive">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<script>
    var GLOBAL_EDIT_ID = "";
     var loginID = "@loginclass.EMP_ID";
    $(document).ready(function () {
        GET_EMR_TEAM_ACTIVATE();
        GET_LOCATION_LIST();
        GET_EMPLOYEE_TYPE();
        GET_EMPLOYEE_LIST("0", "0", "0");

      //  Drop_EmployeeData();
        //$("#spnInputfile").html('');
        //$("#spnInputfile").html('<input id="input-2" name="input2[]" type="file"  accept=".png,.jpg,.jpeg"  class="file"  multiple data-show-upload="true" data-show-caption="true">');

        //var $input = $('input.file[type=file]');



        //$("#spnInputfileVideo").html('');
        //$("#spnInputfileVideo").html('<input id="input-2" name="input2[]" type="file"  accept=".mp4"  class="file" onclick="return Doctype()" multiple data-show-upload="true" data-show-caption="true">');

        //var $inputVideo = $('input.file[type=file]');

        //var FileCount = 5;
        //var VFileCount = 2;

        //if ($input.length) {
        //    ;
        //    $input.fileinput({
        //        uploadUrl: '/Emergency/UploadEmrPhotoFiles',
        //        uploadAsync: false,
        //        previewFileIcon: '<i class="fa fa-file"></i>',
        //        maxFileCount: FileCount,
        //        allowedFileExtensions: ["jpg", "jpeg","png"],
        //    }).on('filebatchuploadsuccess', function (event, data) {
    @*toastr.success(data.response, "@ADQCC_New.LocalResource.Resource.Success");*@
        //    });
        //}

        //if ($inputVideo.length) {
        //    $inputVideo.fileinput({
        //        uploadUrl: '/Emergency/UploadEmpVedioFiles',
        //        uploadAsync: false,
        //        previewFileIcon: '<i class="fa fa-file"></i>',
        //        maxFileCount: VFileCount,
        //        allowedFileExtensions: ["mp4"],
        //    }).on('filebatchuploadsuccess', function (event, data) {
                //alert(data.response);
                //toastr.success(data.response, "@ADQCC_New.LocalResource.Resource.Success");
        //    });
        //}
        var $el3 = $("#input-7051");
        $el3.fileinput({
            allowedFileExtensions: ['jpg', 'png', 'jpeg', 'bmp'],
            uploadUrl: '/Emergency/UploadEmrPhotoFiles',
            uploadAsync: false,
            deleteUrl: '/Emergency/UploadEmrPhotoFiles',
            showUpload: false, // hide upload button
            overwriteInitial: false, // append files to initial preview
            minFileCount: 1,
            maxFileCount: 5,
            browseOnZoneClick: true,
            initialPreviewAsData: true,
        }).on("filebatchselected", function (event, files) {
            $el3.fileinput("upload");
        });

        var $el4 = $("#input-7061");
        $el4.fileinput({
            allowedFileExtensions: ['mp4', 'avi', 'flv'],
            uploadUrl: '/Emergency/UploadEmpVedioFiles',
            uploadAsync: false,
            deleteUrl: '/Emergency/UploadEmpVedioFiles',
            showUpload: false, // hide upload button
            overwriteInitial: false, // append files to initial preview
            minFileCount: 1,
            maxFileCount: 3,
            browseOnZoneClick: true,
            initialPreviewAsData: true,
        }).on("filebatchselected", function (event, files) {
            $el4.fileinput("upload");
        });
        $("#Backbtn").on('click', function () {
            $("#AddEmrType").hide();
            $("#ListView").show();
            ClearUIFields();
            window.location.reload();
        });

    });
    $("#btnsubmit").on('click', function () {

    });


    function ClearUIFields() {
        GLOBAL_EDIT_ID = "";
        $("#tblNewRowCorrective tbody").empty();

    }
    function LoadTeamMembers(id) {

        $.post("@Url.Action("GetEmrTeamById", "Emergency")", { EMP_ACTIVE_ID: GLOBAL_EDIT_ID}, function (data) {
             $(data.EMERGENCY_TYPE_MASTER_SELECT_ID).each(function (g, h) {
                 $(id).append("<option value=" + h.EMP_ID + ">" + h.EMP_FIRSTNAME + "</option>");
            });
        });
    }



      function GET_EMR_TEAM_ACTIVATE() {
        $("#table1").dataTable().fnDestroy();
            $("#AddEmrType").hide();
            $("#ListView").show();
          $.post("@Url.Action("_GetEmergencyTeamMembers", "Emergency")", function (data) {
            $("#GetEmrTeamActive").html('');
            $("#GetEmrTeamActive").html(data);
      });
    }


    function SubmitActionTaken() {
        ;
        var actiontaken = $("#ActionTaken").val();
        var emp_emr_id = $("#EMP_EMERG_TYPE_ID").val();
        if (actiontaken == "") {
            toastr.error("Please Enter the Action Taken", "@ADQCC_New.LocalResource.Resource.Error");
            $("#ActionTaken").focus();
            return false;
        }

        $.post("@Url.Action("AddEMP_ACTION_TAKEN", "Emergency")", { LOGIN_ID: loginID, ACTION_TAKEN: actiontaken, EMP_EMERG_TYPE_ID: emp_emr_id}, function (data) {
            if (data.MESSAGE == "Updated Successfully") {
                F_Approve_Fuction('3');
                 toastr.success(data.MESSAGE, "@ADQCC_New.LocalResource.Resource.Success");
                 GET_EMR_TEAM_ACTIVATE();
                 ClearUIFields();
            }
            else {
               toastr.error(data.MESSAGE, "@ADQCC_New.LocalResource.Resource.Error");
            }
       });
    }

    function togglePopup(ROWID) {

        $("#ListView").hide();
        $("#AddEmrType").show(100);
        $("#DivViewImage").empty();
        $("#DivViewVideo").empty();
        $("#SubmitActionTakenDiv").hide();
        $("#SECHeadApprovepage").hide();
        var emp_emerg_type_id = "";
        var emp_id = loginID;

        var ARRAYFILE_PATH = [];
        var ARRAYFILE_NAME = [];
        var ARRAYFILE_FILE_ID = [];
       // GET_LOCATION_LIST();
        $.post("@Url.Action("GetEmrTeamById", "Emergency")", { EMP_ACTIVE_ID: ROWID }, function (data) {
            ;

            var login = '@loginclass.LANG_ID'
            if (login == "ar") {
                   $("#DivTable").show();
            $("#Building").attr('disabled', 'disabled');
            $("#sectorname").attr('disabled', 'disabled');
            $("#department").attr('disabled', 'disabled');
            $("#section").attr('disabled', 'disabled');
            $("#APPENDIX_A").hide();
            $("#EMP_NAME").val(data.LEAD_MANAGER).prop("disabled", true);
            $("#EmpType").val(data.EMR_TEAM_TYPE).prop("disabled", true);
            $("#location").val(data.LOCATION).attr('disabled', 'disabled');
            $("#LEVEL").val(data.FLOOR).attr('disabled', 'disabled');
            GET_BUILDING_MASTER(data.LOCATION, "#Building", data.BUILDING);

            GET_SECTOR_MASTER("0", "#sectorname", data.SECTOR);

            GET_DEPARTMENT_MASTER(data.SECTOR, "#department", data.DEPARTMENT);

            GET_SECTION_MASTER(data.DEPARTMENT, "#section", data.SECTIONLAB);
            if (data.FILEUPLOAD != null || data.FILEUPLOAD != "") {
                $('<a class="fnsizePDF fa fa-file-pdf-o" target="_blank"/>').attr('href', "" + data.FILEUPLOAD + "").width('25px').height('25px').appendTo($('#DivViewAPPENDIX_A'));
                $('.fnsizePDF').css('font-size', '50px');
                $('.fnsizePDF').css('color', 'red');
            }

            $(data.UPLOAD_DOCUMENT).each(function (k, l) {
                ARRAYFILE_PATH.push(l.EMR_FILE_PATH);
                ARRAYFILE_NAME.push(l.EMR_FILE_NAME);
                ARRAYFILE_FILE_ID.push(l.EMR_PHOTO_ID);
            });

            $(data.EMERGENCY_TYPE_MASTER_SELECT_ID).each(function (g, h) {

                $("#tblTM_Employee_View").append([
                    '<tr >',
                    '<td style="background-color: white;">' + '<lable>' + h.EMP_NAME_AR + ' </lable>' + '</td>',
                    '</tr>'
                ].join(''));
                if (h.EMP_ID == loginID) {
                    $("#TaskAssignBody").empty();
                    emp_emerg_type_id = h.EMP_EMERG_TYPE_ID;
                    $("#TaskAssignBody").append([
                        '<tr >',
                        '<td style="background-color: white;"><input type=hidden id="EMP_EMERG_TYPE_ID" value="' + h.EMP_EMERG_TYPE_ID +'"/>' + '<lable>' + h.TASK + ' </lable>' + '</td>',
                        '<td style="background-color: white;">' + '<lable>' + h.TASK_DES + ' </lable>' + '</td>',
                        '<td style="background-color: white;">' + '<lable>' + h.REVIEW_DATE + ' </lable>' + '</td>',
                        '</tr>'
                    ].join(''));
                }
            });
            $("#kv-explorer").fileinput({
                'theme': 'explorer-fas',
                'maxFileCount': "10",
                showUpload: false,
                showBrowse: false,
                showRemove: false,
                showCancel: false,
                showDelete: false,
                removeIcon: '<i class="glyphicon glyphicon-remove"></i>',
                overwriteInitial: false,
                initialPreviewAsData: true,
                initialPreview: [
                    ARRAYFILE_PATH[0],
                    ARRAYFILE_PATH[1],
                    ARRAYFILE_PATH[2],
                    ARRAYFILE_PATH[3],
                    ARRAYFILE_PATH[4],
                    ARRAYFILE_PATH[5],
                    ARRAYFILE_PATH[6],
                    ARRAYFILE_PATH[7],
                    ARRAYFILE_PATH[8],
                    ARRAYFILE_PATH[9],

                ],
                initialPreviewConfig: [
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[0] + '"', url: ARRAYFILE_PATH[0], key: ARRAYFILE_FILE_ID[0], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[1] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[2] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[3] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[4] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[5] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[6] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[7] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[8] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[9] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },

                ],
                uploadExtraData: {
                    img_key: ARRAYFILE_FILE_ID[0],
                    img_key: ARRAYFILE_FILE_ID[1],
                    img_key: ARRAYFILE_FILE_ID[2],
                    img_key: ARRAYFILE_FILE_ID[3],
                    img_key: ARRAYFILE_FILE_ID[4],
                    img_key: ARRAYFILE_FILE_ID[5],
                    img_key: ARRAYFILE_FILE_ID[6],
                    img_key: ARRAYFILE_FILE_ID[7],
                    img_key: ARRAYFILE_FILE_ID[8],
                    img_key: ARRAYFILE_FILE_ID[9],
                }

            });
            $.post("@Url.Action("GET_EMP_EMR_UPLOADED_FILES", "Emergency")", {EMP_EMERG_TYPE_ID: emp_emerg_type_id,EMP_ID: emp_id}, function (data) {

            $(data).each(function (i, e) {

                $(e.EMP_PHOTO_UPLOAD).each(function (x, Y) {
                    $('<img />').attr('src', "" + Y.EMR_PHOTO_PATH + "").width('250px').appendTo($('#DivViewImage'));
                    $('img').css('padding', '10px');
                });
            });
            $(data).each(function (a, b) {

                $(b.EMP_VIDEO_UPLOAD).each(function (c, d) {
                    $("#DivViewVideo").append("<iframe width=\"200\" height=\"150\" autoplay=\"false\" src=" + d.EMR_VIDEO_PATH + "></iframe>");

                });
            });

            $("#UploadedFiles").show();

        });
            } else {
                   $("#DivTable").show();
            $("#Building").attr('disabled', 'disabled');
            $("#sectorname").attr('disabled', 'disabled');
            $("#department").attr('disabled', 'disabled');
            $("#section").attr('disabled', 'disabled');
            $("#APPENDIX_A").hide();
            $("#EMP_NAME").val(data.LEAD_MANAGER).prop("disabled", true);
            $("#EmpType").val(data.EMR_TEAM_TYPE).prop("disabled", true);
            $("#location").val(data.LOCATION).attr('disabled', 'disabled');
            $("#LEVEL").val(data.FLOOR).attr('disabled', 'disabled');
            GET_BUILDING_MASTER(data.LOCATION, "#Building", data.BUILDING);

            GET_SECTOR_MASTER("0", "#sectorname", data.SECTOR);

            GET_DEPARTMENT_MASTER(data.SECTOR, "#department", data.DEPARTMENT);

            GET_SECTION_MASTER(data.DEPARTMENT, "#section", data.SECTIONLAB);
            if (data.FILEUPLOAD != null || data.FILEUPLOAD != "") {
                $('<a class="fnsizePDF fa fa-file-pdf-o" target="_blank"/>').attr('href', "" + data.FILEUPLOAD + "").width('25px').height('25px').appendTo($('#DivViewAPPENDIX_A'));
                $('.fnsizePDF').css('font-size', '50px');
                $('.fnsizePDF').css('color', 'red');
            }

            $(data.UPLOAD_DOCUMENT).each(function (k, l) {
                ARRAYFILE_PATH.push(l.EMR_FILE_PATH);
                ARRAYFILE_NAME.push(l.EMR_FILE_NAME);
                ARRAYFILE_FILE_ID.push(l.EMR_PHOTO_ID);
            });

            $(data.EMERGENCY_TYPE_MASTER_SELECT_ID).each(function (g, h) {

                $("#tblTM_Employee_View").append([
                    '<tr >',
                    '<td style="background-color: white;">' + '<lable>' + h.EMP_FIRSTNAME + ' </lable>' + '</td>',
                    '</tr>'
                ].join(''));
                if (h.EMP_ID == loginID) {
                    $("#TaskAssignBody").empty();
                    emp_emerg_type_id = h.EMP_EMERG_TYPE_ID;
                    $("#TaskAssignBody").append([
                        '<tr >',
                        '<td style="background-color: white;"><input type=hidden id="EMP_EMERG_TYPE_ID" value="' + h.EMP_EMERG_TYPE_ID +'"/>' + '<lable>' + h.TASK + ' </lable>' + '</td>',
                        '<td style="background-color: white;">' + '<lable>' + h.TASK_DES + ' </lable>' + '</td>',
                        '<td style="background-color: white;">' + '<lable>' + h.REVIEW_DATE + ' </lable>' + '</td>',
                        '</tr>'
                    ].join(''));
                }
            });
            $("#kv-explorer").fileinput({
                'theme': 'explorer-fas',
                'maxFileCount': "10",
                showUpload: false,
                showBrowse: false,
                showRemove: false,
                showCancel: false,
                showDelete: false,
                removeIcon: '<i class="glyphicon glyphicon-remove"></i>',
                overwriteInitial: false,
                initialPreviewAsData: true,
                initialPreview: [
                    ARRAYFILE_PATH[0],
                    ARRAYFILE_PATH[1],
                    ARRAYFILE_PATH[2],
                    ARRAYFILE_PATH[3],
                    ARRAYFILE_PATH[4],
                    ARRAYFILE_PATH[5],
                    ARRAYFILE_PATH[6],
                    ARRAYFILE_PATH[7],
                    ARRAYFILE_PATH[8],
                    ARRAYFILE_PATH[9],

                ],
                initialPreviewConfig: [
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[0] + '"', url: ARRAYFILE_PATH[0], key: ARRAYFILE_FILE_ID[0], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[1] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[2] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[3] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[4] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[5] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[6] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[7] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[8] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                    { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[9] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },

                ],
                uploadExtraData: {
                    img_key: ARRAYFILE_FILE_ID[0],
                    img_key: ARRAYFILE_FILE_ID[1],
                    img_key: ARRAYFILE_FILE_ID[2],
                    img_key: ARRAYFILE_FILE_ID[3],
                    img_key: ARRAYFILE_FILE_ID[4],
                    img_key: ARRAYFILE_FILE_ID[5],
                    img_key: ARRAYFILE_FILE_ID[6],
                    img_key: ARRAYFILE_FILE_ID[7],
                    img_key: ARRAYFILE_FILE_ID[8],
                    img_key: ARRAYFILE_FILE_ID[9],
                }

            });
            $.post("@Url.Action("GET_EMP_EMR_UPLOADED_FILES", "Emergency")", {EMP_EMERG_TYPE_ID: emp_emerg_type_id,EMP_ID: emp_id}, function (data) {

            $(data).each(function (i, e) {

                $(e.EMP_PHOTO_UPLOAD).each(function (x, Y) {
                    $('<img />').attr('src', "" + Y.EMR_PHOTO_PATH + "").width('250px').appendTo($('#DivViewImage'));
                    $('img').css('padding', '10px');
                });
            });
            $(data).each(function (a, b) {

                $(b.EMP_VIDEO_UPLOAD).each(function (c, d) {
                    $("#DivViewVideo").append("<iframe width=\"200\" height=\"150\" autoplay=\"false\" src=" + d.EMR_VIDEO_PATH + "></iframe>");

                });
            });

            $("#UploadedFiles").show();

        });
            }



        });


    }


    function EMR_VIEW(ROWID, show) {

        ClearUIFields();
        switch (show) {

            case "1":
                $("#ListView").hide();
                $("#AddEmrType").show(100);
                $("#DivEditkvexplorer").show();
                $("#SubmitActionTakenDiv").show();
                $("#UploadedFiles").hide();
                $("#SECHeadApprovepage").hide();
                $('#tblTM_Employee_View').find('tbody').empty();
                break;
            case "2":
                $("#ListView").hide();
                $("#AddEmrType").show(100);
                $("#DivEditkvexplorer").show();
                $("#SubmitActionTakenDiv").hide();
                $("#UploadedFiles").hide();
                $("#SECHeadApprovepage").hide();
                $('#tblTM_Employee_View').find('tbody').empty();
                break;
            default:
                $("#ListView").hide();
                $("#AddEmrType").show(100);
                $("#DivEditkvexplorer").show();
                $("#SECHeadApprovepage").show();
                $("#UploadedFiles").hide();
                $("#SubmitActionTakenDiv").hide();
                $('#tblTM_Employee_View').find('tbody').empty();
                break;
        }



        var ARRAYFILE_PATH = [];
        var ARRAYFILE_NAME = [];
        var ARRAYFILE_FILE_ID = [];
        //GET_LOCATION_LIST();
        $.post("@Url.Action("GetEmrTeamById", "Emergency")", { EMP_ACTIVE_ID: ROWID }, function (data) {
            ;
            var login = '@loginclass.LANG_ID'
            if (login == "ar") {
                $("#DivTable").show();
                $("#Building").attr('disabled', 'disabled');
                $("#sectorname").attr('disabled', 'disabled');
                $("#department").attr('disabled', 'disabled');
                $("#section").attr('disabled', 'disabled');
                $("#APPENDIX_A").hide();
                $("#EMP_NAME").val(data.LEAD_MANAGER).prop("disabled", true);
                $("#EmpType").val(data.EMR_TEAM_TYPE).prop("disabled", true);
                $("#location").val(data.LOCATION).attr('disabled', 'disabled');
                $("#LEVEL").val(data.FLOOR).attr('disabled', 'disabled');
                GET_BUILDING_MASTER(data.LOCATION, "#Building", data.BUILDING);

                GET_SECTOR_MASTER("0", "#sectorname", data.SECTOR);

                GET_DEPARTMENT_MASTER(data.SECTOR, "#department", data.DEPARTMENT);

                GET_SECTION_MASTER(data.DEPARTMENT, "#section", data.SECTIONLAB);
                if (data.FILEUPLOAD != null || data.FILEUPLOAD != "") {
                    $('<a class="fnsizePDF fa fa-file-pdf-o" target="_blank"/>').attr('href', "" + data.FILEUPLOAD + "").width('25px').height('25px').appendTo($('#DivViewAPPENDIX_A'));
                    $('.fnsizePDF').css('font-size', '50px');
                    $('.fnsizePDF').css('color', 'red');
                }

                $(data.UPLOAD_DOCUMENT).each(function (k, l) {
                    ARRAYFILE_PATH.push(l.EMR_FILE_PATH);
                    ARRAYFILE_NAME.push(l.EMR_FILE_NAME);
                    ARRAYFILE_FILE_ID.push(l.EMR_PHOTO_ID);
                });

                $(data.EMERGENCY_TYPE_MASTER_SELECT_ID).each(function (g, h) {

                    $("#tblTM_Employee_View").append([
                        '<tr >',
                        '<td style="background-color: white;">' + '<lable>' + h.EMP_NAME_AR + ' </lable>' + '</td>',
                        '</tr>'
                    ].join(''));
                    if (h.EMP_ID == loginID) {
                        $("#TaskAssignBody").empty();
                        $("#TaskAssignBody").append([
                            '<tr >',
                            '<td style="background-color: white;"><input type=hidden id="EMP_EMERG_TYPE_ID" value="' + h.EMP_EMERG_TYPE_ID + '"/>' + '<lable>' + h.TASK + ' </lable>' + '</td>',
                            '<td style="background-color: white;">' + '<lable>' + h.TASK_DES + ' </lable>' + '</td>',
                            '<td style="background-color: white;">' + '<lable>' + h.REVIEW_DATE + ' </lable>' + '</td>',
                            '</tr>'
                        ].join(''));
                    }
                });
                $("#kv-explorer").fileinput({
                    'theme': 'explorer-fas',
                    'maxFileCount': "10",
                    showUpload: false,
                    showBrowse: false,
                    showRemove: false,
                    showCancel: false,
                    showDelete: false,
                    removeIcon: '<i class="glyphicon glyphicon-remove"></i>',
                    overwriteInitial: false,
                    initialPreviewAsData: true,
                    initialPreview: [
                        ARRAYFILE_PATH[0],
                        ARRAYFILE_PATH[1],
                        ARRAYFILE_PATH[2],
                        ARRAYFILE_PATH[3],
                        ARRAYFILE_PATH[4],
                        ARRAYFILE_PATH[5],
                        ARRAYFILE_PATH[6],
                        ARRAYFILE_PATH[7],
                        ARRAYFILE_PATH[8],
                        ARRAYFILE_PATH[9],

                    ],
                    initialPreviewConfig: [
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[0] + '"', url: ARRAYFILE_PATH[0], key: ARRAYFILE_FILE_ID[0], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[1] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[2] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[3] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[4] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[5] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[6] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[7] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[8] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[9] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },

                    ],
                    uploadExtraData: {
                        img_key: ARRAYFILE_FILE_ID[0],
                        img_key: ARRAYFILE_FILE_ID[1],
                        img_key: ARRAYFILE_FILE_ID[2],
                        img_key: ARRAYFILE_FILE_ID[3],
                        img_key: ARRAYFILE_FILE_ID[4],
                        img_key: ARRAYFILE_FILE_ID[5],
                        img_key: ARRAYFILE_FILE_ID[6],
                        img_key: ARRAYFILE_FILE_ID[7],
                        img_key: ARRAYFILE_FILE_ID[8],
                        img_key: ARRAYFILE_FILE_ID[9],
                    }

                });
            } else {
                $("#DivTable").show();
                $("#Building").attr('disabled', 'disabled');
                $("#sectorname").attr('disabled', 'disabled');
                $("#department").attr('disabled', 'disabled');
                $("#section").attr('disabled', 'disabled');
                $("#APPENDIX_A").hide();
                $("#EMP_NAME").val(data.LEAD_MANAGER).prop("disabled", true);
                $("#EmpType").val(data.EMR_TEAM_TYPE).prop("disabled", true);
                $("#location").val(data.LOCATION).attr('disabled', 'disabled');
                $("#LEVEL").val(data.FLOOR).attr('disabled', 'disabled');
                GET_BUILDING_MASTER(data.LOCATION, "#Building", data.BUILDING);

                GET_SECTOR_MASTER("0", "#sectorname", data.SECTOR);

                GET_DEPARTMENT_MASTER(data.SECTOR, "#department", data.DEPARTMENT);

                GET_SECTION_MASTER(data.DEPARTMENT, "#section", data.SECTIONLAB);
                if (data.FILEUPLOAD != null || data.FILEUPLOAD != "") {
                    $('<a class="fnsizePDF fa fa-file-pdf-o" target="_blank"/>').attr('href', "" + data.FILEUPLOAD + "").width('25px').height('25px').appendTo($('#DivViewAPPENDIX_A'));
                    $('.fnsizePDF').css('font-size', '50px');
                    $('.fnsizePDF').css('color', 'red');
                }

                $(data.UPLOAD_DOCUMENT).each(function (k, l) {
                    ARRAYFILE_PATH.push(l.EMR_FILE_PATH);
                    ARRAYFILE_NAME.push(l.EMR_FILE_NAME);
                    ARRAYFILE_FILE_ID.push(l.EMR_PHOTO_ID);
                });

                $(data.EMERGENCY_TYPE_MASTER_SELECT_ID).each(function (g, h) {

                    $("#tblTM_Employee_View").append([
                        '<tr >',
                        '<td style="background-color: white;">' + '<lable>' + h.EMP_FIRSTNAME + ' </lable>' + '</td>',
                        '</tr>'
                    ].join(''));
                    if (h.EMP_ID == loginID) {
                        $("#TaskAssignBody").empty();
                        $("#TaskAssignBody").append([
                            '<tr >',
                            '<td style="background-color: white;"><input type=hidden id="EMP_EMERG_TYPE_ID" value="' + h.EMP_EMERG_TYPE_ID + '"/>' + '<lable>' + h.TASK + ' </lable>' + '</td>',
                            '<td style="background-color: white;">' + '<lable>' + h.TASK_DES + ' </lable>' + '</td>',
                            '<td style="background-color: white;">' + '<lable>' + h.REVIEW_DATE + ' </lable>' + '</td>',
                            '</tr>'
                        ].join(''));
                    }
                });
                $("#kv-explorer").fileinput({
                    'theme': 'explorer-fas',
                    'maxFileCount': "10",
                    showUpload: false,
                    showBrowse: false,
                    showRemove: false,
                    showCancel: false,
                    showDelete: false,
                    removeIcon: '<i class="glyphicon glyphicon-remove"></i>',
                    overwriteInitial: false,
                    initialPreviewAsData: true,
                    initialPreview: [
                        ARRAYFILE_PATH[0],
                        ARRAYFILE_PATH[1],
                        ARRAYFILE_PATH[2],
                        ARRAYFILE_PATH[3],
                        ARRAYFILE_PATH[4],
                        ARRAYFILE_PATH[5],
                        ARRAYFILE_PATH[6],
                        ARRAYFILE_PATH[7],
                        ARRAYFILE_PATH[8],
                        ARRAYFILE_PATH[9],

                    ],
                    initialPreviewConfig: [
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[0] + '"', url: ARRAYFILE_PATH[0], key: ARRAYFILE_FILE_ID[0], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[1] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[2] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[3] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[4] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[5] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[6] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[7] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[8] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },
                        { type: "pdf", size: 8000, caption: '"' + ARRAYFILE_NAME[9] + '"', url: ARRAYFILE_PATH[1], key: ARRAYFILE_FILE_ID[1], downloadUrl: false, width: "150px" },

                    ],
                    uploadExtraData: {
                        img_key: ARRAYFILE_FILE_ID[0],
                        img_key: ARRAYFILE_FILE_ID[1],
                        img_key: ARRAYFILE_FILE_ID[2],
                        img_key: ARRAYFILE_FILE_ID[3],
                        img_key: ARRAYFILE_FILE_ID[4],
                        img_key: ARRAYFILE_FILE_ID[5],
                        img_key: ARRAYFILE_FILE_ID[6],
                        img_key: ARRAYFILE_FILE_ID[7],
                        img_key: ARRAYFILE_FILE_ID[8],
                        img_key: ARRAYFILE_FILE_ID[9],
                    }

                });
            }

        });

    }

    function ClearUIFields() {
        $("#ActionTaken").val('');
        //$('#input-7051').val('');
        //$('#input-7061').val('');
        $('#input-7051').replaceWith($('#input-7051').val('').clone(true));
        $('#input-7061').replaceWith($('#input-7061').val('').clone(true));
    }


    function GET_LOCATION_LIST() {
        $.post("@Url.Action("_GetLocationMasterSelect", "Masters")", function (data) {
             $("#location").empty();
            $("#location").append("<option value='0'> ---@ADQCC_New.LocalResource.Resource.SelectLocation--</option>");
            $(data).each(function (i, e) {
                if ('@loginclass.LANG_ID' == "ar") {
                    $("#location").append("<option value=" + e.LOC_ID + ">" + e.LOC_NAME_AR + "</option>");
                } else {
                    $("#location").append("<option value=" + e.LOC_ID + ">" + e.LOC_NAME + "</option>");

                }

             });
         });
    }
    function GET_BUILDING_LIST(locid) {
        $.post("@Url.Action("_GetBuildingMasterSelect", "Masters")", { LOCID: locid }, function (data) {
            $("#Building").empty();
            $("#Building").append("<option value='0'> --@ADQCC_New.LocalResource.Resource.SelectBuilding--</option>");
            $(data).each(function (i, e) {
                if ('@loginclass.LANG_ID' == "ar") {
                    $("#Building").append("<option value=" + e.BUIL_ID + ">" + e.BUIL_NAME_AR + "</option>");
                } else {
                    $("#Building").append("<option value=" + e.BUIL_ID + ">" + e.BUIL_NAME + "</option>");

                }

             });
         });
    }
    function GET_SECTOR_LIST(builid) {
        $.post("@Url.Action("_GetSectorMasterSelect", "Masters")", { BUILID: "0" }, function (data) {
            $("#sectorname").empty();
            $("#sectorname").append("<option value='0'> --@ADQCC_New.LocalResource.Resource.SelectSectorName--</option>");
            $(data).each(function (i, e) {
                if ('@loginclass.LANG_ID' == "ar") {
                    $("#sectorname").append("<option value=" + e.SEC_ID + ">" + e.SEC_NAME_ARB + "</option>");
                } else {
                    $("#sectorname").append("<option value=" + e.SEC_ID + ">" + e.SEC_NAME_EN + "</option>");

                }


             });
         });
    }
    function GET_DEPARTMENT_LIST(secid) {
        $.post("@Url.Action("_GetDepartmentMasterSelect", "Masters")", { SECID: secid }, function (data) {
            $("#department").empty();
            $("#department").append("<option value='0'> --@ADQCC_New.LocalResource.Resource.SelectDepartment--</option>");
            $(data).each(function (i, e) {
                 if ('@loginclass.LANG_ID' == "ar") {
                     $("#department").append("<option value=" + e.DEP_ID + ">" + e.DEP_NAME_AR + "</option>");
                } else {
                     $("#department").append("<option value=" + e.DEP_ID + ">" + e.DEP_NAME + "</option>");

                }

             });
         });
    }

    function GET_SECTION_LIST(depid) {
        $.post("@Url.Action("_GetSectionMasterSelect", "Masters")", { DEPID: depid }, function (data) {
            $("#section").empty();
            $("#section").append("<option value='0'> --@ADQCC_New.LocalResource.Resource.SelectSection--</option>");
            $(data).each(function (i, e) {
                if ('@loginclass.LANG_ID' == "ar") {
                    $("#section").append("<option value=" + e.SEC_LAB_ID + ">" + e.SEC_LAB_NAME_AR + "</option>");
                } else {
                    $("#section").append("<option value=" + e.SEC_LAB_ID + ">" + e.SEC_LAB_NAME + "</option>");

                }

             });
         });
    }
    function GET_BUILDING_MASTER(RefTransID, controlid, selectedValue) {
        ;
        $(controlid).html("");
        $.post("@Url.Action("_GetBuildingMasterSelect", "Masters")", { LOCID: RefTransID}, function (data) {
            if (data != null) {
                $(controlid).append("<option value='0'>--@ADQCC_New.LocalResource.Resource.SelectBuilding--</option>");
                $.each(data, function (index, item) {
                    $(controlid).append(new Option(item.BUIL_NAME, item.BUIL_ID));
                });
                if (selectedValue != null)
                    $(controlid).val(selectedValue);
            }
        }).always(function () {

        });
    }



    function GET_SECTOR_MASTER(RefTransID, controlid, selectedValue) {
        ;
        $(controlid).html("");
        $.post("@Url.Action("_GetSectorMasterSelect", "Masters")", { BUILID: RefTransID}, function (data) {
            if (data != null) {
                $(controlid).append("<option value='0'>--@ADQCC_New.LocalResource.Resource.SelectSectorName--</option>");
                $.each(data, function (index, item) {
                    $(controlid).append(new Option(item.SEC_NAME_EN, item.SEC_ID));
                });
                if (selectedValue != null)
                    $(controlid).val(selectedValue);
            }
        }).always(function () {

        });
    }


    function GET_DEPARTMENT_MASTER(RefTransID, controlid, selectedValue) {
        ;
        $(controlid).html("");
        $.post("@Url.Action("_GetDepartmentMasterSelect", "Masters")", { SECID: RefTransID}, function (data) {
            if (data != null) {
                $(controlid).append("<option value='0'>--@ADQCC_New.LocalResource.Resource.SelectDepartment--</option>");
                $.each(data, function (index, item) {
                    $(controlid).append(new Option(item.DEP_NAME, item.DEP_ID));
                });
                if (selectedValue != null)
                    $(controlid).val(selectedValue);
            }
        }).always(function () {

        });
    }

     function Approve_Fuction(status)
        {

         var emp_emerg_id = $("#EMP_EMERG_TYPE_ID").val();
         $.post("@Url.Action("ADDUpdate_Accept_Reject", "Emergency")", { LOGIN_ID: loginID, STATUS: status, EMP_EMERG_TYPE_ID: emp_emerg_id }, function (data) {
             if (data.STATUS_CODE == "200") {
                 toastr.success(data.MESSAGE, "@ADQCC_New.LocalResource.Resource.Success");
                 GET_EMR_TEAM_ACTIVATE();
                 ClearUIFields();
            }
            else {
               toastr.error(data.MESSAGE, "@ADQCC_New.LocalResource.Resource.Error");
            }
       });

     }
    function F_Approve_Fuction(status)
        {

         var emp_emerg_id = $("#EMP_EMERG_TYPE_ID").val();
         $.post("@Url.Action("ADDUpdate_Accept_Reject", "Emergency")", { LOGIN_ID: loginID, STATUS: status, EMP_EMERG_TYPE_ID: emp_emerg_id }, function (data) {
             if (data.STATUS_CODE == "200") {

            }
            else {

            }
       });

     }
    function GET_SECTION_MASTER(RefTransID, controlid, selectedValue) {
        ;
        $(controlid).html("");
        $.post("@Url.Action("_GetSectionMasterSelect", "Masters")", { DEPID: RefTransID}, function (data) {
            if (data != null) {
                $(controlid).append("<option value='0'>--@ADQCC_New.LocalResource.Resource.SelectSection--</option>");
                $.each(data, function (index, item) {
                    $(controlid).append(new Option(item.SEC_LAB_NAME, item.SEC_LAB_ID));
                });
                if (selectedValue != null)
                    $(controlid).val(selectedValue);
            }
        }).always(function () {

        });
    }
    function GET_EMPLOYEE_TYPE() {
            ;
            $.post("@Url.Action("_GetEmergencyTeamDrop", "EmployeeDetails")", function (data) {
                ;
                $("#EmpType").empty();
                $("#EmpType").append("<option value='0'>--@ADQCC_New.LocalResource.Resource.EMRSelecttheEmergencyTeam --</option>");
                $(data).each(function (i, e) {
                if ('@loginclass.LANG_ID' == "ar") {
                    $("#EmpType").append("<option value=" + e.EMERG_TYPE_MAS_ID + ">" + e.EMERG_TYPE_MAS_AR + "</option>");
                } else {
                    $("#EmpType").append("<option value=" + e.EMERG_TYPE_MAS_ID + ">" + e.EMERG_TYPE_MAS + "</option>");

                }


            });
         });
    }
    function EmrEmployeeload() {
        ;
        $('#tblTM_Employee_View').find('tbody').empty();
        var VarEMERG_TYPE_MAS_ID = $("#EmpType").val();
        var VarLOC_ID = $("#location").val();
        var VarBUILD_ID = $("#Building").val();
        var VarLEVEL_ID = $("#LEVEL").val();
          var model = {
                EMERG_TYPE_MAS_ID: VarEMERG_TYPE_MAS_ID,
                LOC_ID: VarLOC_ID,
                BUILD_ID: VarBUILD_ID,
                LEVEL_ID: VarLEVEL_ID,
            };
        $.post("@Url.Action("GetSelectEmergencyTeamEmployee", "Emergency")", {EMERG_TYPE:model}, function (data) {
            $(data).each(function (i, e) {
                if (e.STATUS_CODE == "200") {
                    $("#DivTable").show();
                    $('#tblTM_Employee_View').append([
                        '<tr>',
                        '<td style="background-color: white;">' + '<lable>' + e.EMP_FIRSTNAME + ' </lable>' + '</td>',
                        '</tr>'
                    ].join(''));
                }
            });
        });
    }


    function GET_EMPLOYEE_LIST(emp_id, emp_name, emp_desi) {
            ;

             $.post("@Url.Action("GetSelectEmployeeLoad", "TrainingManagement")", function (data) {
                 $("#EMP_NAME").empty();
                 $("#EMP_NAME").append("<option value='0'>--@ADQCC_New.LocalResource.Resource.EMRSelecttheLeadManager--</option > ");

                 $(data).each(function (i, e) {
                     if ('@loginclass.LANG_ID' == "ar") {
                         $("#EMP_NAME").append("<option value=" + e.EMPLOYEE_ID + ">" + e.EMP_NAME_AR + "</option>");
                     } else
                     {
                         $("#EMP_NAME").append("<option value=" + e.EMPLOYEE_ID + ">" + e.EMPLOYEE_NAME + "</option>");

                      }

                });
            });

    }
    function FunctionHelp() {
        ;
        window.open('@Url.Action("EmergencyMemberHelpDoc", "Emergency")');
    }
</script>
